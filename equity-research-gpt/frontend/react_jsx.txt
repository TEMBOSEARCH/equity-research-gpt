import React, { useEffect, useState } from 'react'
import axios from 'axios'

const API = (p) => (window.location.hostname === 'localhost' ? 'http://localhost:8000' : '') + p

export default function App() {
  const [q, setQ] = useState('')
  const [wz, setWz] = useState('')
  const [source, setSource] = useState('')
  const [ftype, setFtype] = useState('')
  const [start, setStart] = useState('')
  const [end, setEnd] = useState('')
  const [companies, setCompanies] = useState([])
  const [filings, setFilings] = useState([])

  const loadCompanies = async () => {
    const params = {}
    if (q) params.q = q
    if (wz) params.wz = wz
    const r = await axios.get(API('/companies'), { params })
    setCompanies(r.data)
  }

  const loadFilings = async () => {
    const params = {}
    if (source) params.source = source
    if (ftype) params.filing_type = ftype
    if (start) params.start = start
    if (end) params.end = end
    if (q) params.q = q
    const r = await axios.get(API('/filings'), { params })
    setFilings(r.data)
  }

  useEffect(() => { loadCompanies(); }, [])

  return (
    <div style={{ padding: 16, fontFamily: 'system-ui, Arial' }}>
      <h1>Equity Screening (DACH)</h1>
      <div style={{ display:'grid', gridTemplateColumns:'1fr 1fr 1fr 1fr 1fr 1fr auto', gap:8, marginBottom:12 }}>
        <input placeholder="Suche (Name/Titel)" value={q} onChange={e=>setQ(e.target.value)} />
        <input placeholder="WZ-Code" value={wz} onChange={e=>setWz(e.target.value)} />
        <select value={source} onChange={e=>setSource(e.target.value)}>
          <option value="">Quelle</option>
          <option value="northdata">northdata</option>
          <option value="bundesanzeiger">bundesanzeiger</option>
        </select>
        <input placeholder="Filing-Typ (z.B. annual_report)" value={ftype} onChange={e=>setFtype(e.target.value)} />
        <input type="date" value={start} onChange={e=>setStart(e.target.value)} />
        <input type="date" value={end} onChange={e=>setEnd(e.target.value)} />
        <button onClick={()=>{loadCompanies(); loadFilings();}}>Suchen</button>
      </div>

      <h2>Companies</h2>
      <table border="1" cellPadding="6"><thead><tr>
        <th>ID</th><th>Name</th><th>Country</th><th>WZ</th>
      </tr></thead><tbody>
        {companies.map(c => <tr key={c.id}><td>{c.id}</td><td>{c.name}</td><td>{c.country}</td><td>{c.wz_code||''}</td></tr>)}
      </tbody></table>

      <h2 style={{ marginTop: 24 }}>Filings</h2>
      <table border="1" cellPadding="6"><thead><tr>
        <th>ID</th><th>Company</th><th>Title</th><th>Source</th><th>Type</th><th>Date</th>
      </tr></thead><tbody>
        {filings.map(f => <tr key={f.id}><td>{f.id}</td><td>{f.company_id}</td><td>{f.title}</td>
          <td>{f.source}</td><td>{f.filing_type}</td><td>{f.filing_date || ''}</td></tr>)}
      </tbody></table>
    </div>
  )
}
import React, { useEffect, useState } from 'react'
import axios from 'axios'
const API = (p) => (window.location.hostname === 'localhost' ? 'http://localhost:8000' : '') + p

export default function App() {
  // ... deine bestehenden States ...
  const [psCountries, setPsCountries] = useState('')
  const [psLegalForm, setPsLegalForm] = useState('')
  const [psEventType, setPsEventType] = useState('')
  const [psStart, setPsStart] = useState('')
  const [psEnd, setPsEnd] = useState('')
  const [psRes, setPsRes] = useState([])

  const powerSearch = async () => {
    const params = {
      source: 'bundesanzeiger',
      countries: psCountries || undefined,
      legalForm: psLegalForm || undefined,
      eventType: psEventType || undefined,
      minPublicationDate: psStart || undefined,
      maxPublicationDate: psEnd || undefined,
      limit: 50
    }
    const r = await axios.get(API('/northdata/publications'), { params })
    const items = r.data.publications || r.data.items || []
    setPsRes(items)
  }

  return (
    <div style={{ padding: 16, fontFamily: 'system-ui, Arial' }}>
      {/* dein bisheriges UI â€¦ */}

      <h2 style={{ marginTop: 32 }}>Power Search (North Data, on-demand)</h2>
      <div style={{ display:'grid', gridTemplateColumns:'repeat(6, 1fr) auto', gap:8, marginBottom:12 }}>
        <input placeholder="countries (z.B. DE,AT)" value={psCountries} onChange={e=>setPsCountries(e.target.value)} />
        <input placeholder="legalForm (z.B. AG,GmbH)" value={psLegalForm} onChange={e=>setPsLegalForm(e.target.value)} />
        <input placeholder="eventType (frei)" value={psEventType} onChange={e=>setPsEventType(e.target.value)} />
        <input type="date" value={psStart} onChange={e=>setPsStart(e.target.value)} />
        <input type="date" value={psEnd} onChange={e=>setPsEnd(e.target.value)} />
        <div />
        <button onClick={powerSearch}>Power Search</button>
      </div>

      <table border="1" cellPadding="6">
        <thead>
          <tr><th>Title</th><th>Publisher</th><th>Topic</th><th>Date</th><th>Link</th></tr>
        </thead>
        <tbody>
          {psRes.map((p, i) => (
            <tr key={i}>
              <td>{p.title || p.subject}</td>
              <td>{(p.publisher && p.publisher.name) || p.companyName}</td>
              <td>{p.topic || p.topicType}</td>
              <td>{p.publicationDate || p.timestamp}</td>
              <td>{p.url ? <a href={p.url} target="_blank" rel="noreferrer">open</a> : ''}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  )
}
